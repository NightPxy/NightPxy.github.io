---
layout: post
title:  "Hadoop 压缩"
date:   2018-07-02 13:31:01 +0800
categories: hadoop
tag: hadoop
---

* content
{:toc}


## 

文件压缩的优点  

* 减少存储空间  
* 减少网络传输  

文件压缩的缺点  

* 消耗CPU的计算能力  

## 压缩方式的对比  

压缩方式的对比主要从 **压缩特性** 和 **压缩性能** 两个维度进行比较  

* 压缩特性  
压缩特性主要指是否内置,是否native等,但最重要的核心指标是 **是否可分割**  
* 压缩性能  
压缩性能的核心指标是 **压缩比** 和 **压缩/解压速率**  

各压缩方式的详细指标对比如下:  

**压缩特性**  

| 压缩格式 | codec | 扩展名| 多文件 |splitable | native| 工具 | 内置 |
| --- | --- | ---| ---|---| ---| ---|---|
| gzip | GzipCodec | .gz | 否 | 否 | 是 |gzip |是|
| bzip2 | bzip2 |.bz2|是|是|否|bzip2|是|
| lzo |LzopCodec|.lzo|否|是|是|lzop|否|
| snappy |SnappyCodec|.snappy|否|否|是|无|否|

***压缩性能**  

|压缩格式|压缩比|压缩速率|解压速率|
| --- | --- | ---| ---|
|gzip|13.4%|21 MB/s|118 MB/s|
|lzo|20.5%|135 MB/s|410 MB/s|
|snappy|22.2%|172 MB/s|409 MB/s|
|bzip2|13.2%|2.4MB/s|9.5MB/s|

**详细分析**  

* **gzip**  
gzip 有最好的压缩比,但是压缩速度比较一般,并且最最重要的是不支持切割
所以gzip用处是比较小的,不支持切割代表不适用与Map输入,
只适用强烈要求压缩比,不要求压缩速度,且不需要并行读取.但是不需要并行读取的场景非常少,如果真的不要求压缩速度,宁肯选择bzip2  
* **lzo**  
lzo应该是实际工作中的首选  
lzo 有不错的压缩比和非常不错的加解压速度,并且可以是可切割的  
lzo的劣势是非内置和切割必须依赖索引,但这些是可以克服的,非内置可以做内置,索引可以做自动索引等等  
* **snappy**  
snappy 也是一种经常使用的
因为它有可以接受的压缩比和最快的加解压速度,但是不支持切割  
代表着它适用与快速压缩且无需分割的场景,比如 shuffle压缩
* **bzip2**  


参考博客
http://www.hainiubl.com/topics/26
export HADOOP_OPTS="-Djava.library.path=${HADOOP_HOME}/lib/native/"